import 'dart:convert';
import 'package:flutter/foundation.dart';
import 'package:font_awesome_flutter/font_awesome_flutter.dart';
import 'package:news_app/news_list.dart';

String weatherDescription(jsonData) {
  var data = json.decode(jsonData);

  List<int> weatherCodes = List<int>.from(data['hourly']['weathercode']);

  Map<int, String> weatherDictionary = {
    -8: '厚い巻層雲',
    -7: '暴風雪',
    -6: '暴風',
    -5: '氷雨',
    -4: '濃い霧',
    -3: '大雪',
    -2: '激しい雨',
    -1: '激しい雨',
    0: '快晴',
    1: 'おおむね晴れ',
    2: '主に晴れ',
    3: '長い晴れ間',
    4: '一部曇り',
    5: '雲の切れ間',
    6: 'やや曇り',
    7: '主に曇り',
    8: '曇り',
    9: '???',
    10: '霧',
    11: '霧',
    12: '霧',
    13: '雷',
    14: 'にわか雨',
    15: 'にわか雨',
    16: 'にわか雨',
    17: '孤立した雷雨',
    18: '突風',
    19: '吹き出し',
    20: '霧雨の可能性',
    21: '雨の可能性',
    22: '雪の可能性',
    23: '小雨と雪',
    24: '軽い氷雨',
    25: '小雨',
    26: '小雪',
    27: '小雪または雨雪混じりのにわか雨',
    28: '霧の可能性',
    29: '孤立した雷雨',
    30: '砂嵐',
    31: '砂嵐',
    32: '砂嵐',
    33: '激しい砂嵐',
    34: '激しい砂嵐',
    35: '激しい砂嵐',
    36: 'スノーフラッシャー',
    37: '大雪',
    38: '流れ雪',
    39: '重い雪',
    40: 'パッチ状の霧',
    41: 'パッチ状の霧',
    42: '霧',
    43: '霧',
    44: '霧',
    45: '濃霧',
    46: '濃霧',
    47: '濃霧',
    48: '氷結霧',
    49: '凍てつく霧',
    50: '弱い霧雨',
    51: '弱い霧雨',
    52: '時折降る霧雨',
    53: '霧雨',
    54: '時折強い霧雨',
    55: '激しい霧雨',
    56: '氷雨',
    57: '氷雨',
    58: '霧雨と雨',
    59: '霧雨と雨',
    60: '時雨',
    61: '小雨',
    62: '時雨',
    63: '雨',
    64: 'ときどき強い雨',
    65: '激しい雨',
    66: '氷雨',
    67: '氷雨',
    68: '雨と雪',
    69: '大雨と雪',
    70: '時折雪',
    71: '小雪',
    72: 'ときどき雪',
    73: '雪',
    74: 'ときどき大雪',
    75: '大雪',
    76: 'ダイヤモンドダスト',
    77: '雪の粒',
    78: '雪の結晶',
    79: '氷の粒',
    80: 'にわか雨',
    81: '激しい雨',
    82: '激しいにわか雨',
    83: '雨と雪のシャワー',
    84: '激しい雨と雪',
    85: 'スノーシャワー',
    86: '激しい雪のシャワー',
    87: '小雪または雨雪混じりのにわか雨',
    88: '小雪または雨雪混じりの激しいにわか雨',
    89: '雹',
    90: '激しいあられ',
    91: '雷雨',
    92: '雷雨',
    93: '雷雨',
    94: '雷雨',
    95: '雷雨',
    96: '雷雨',
    97: '激しい雷雨',
    98: '砂嵐を伴う激しい雷雨',
    99: '雹または突風を伴う激しい雷雨'
  };

  int morningWeatherCode = 98; //weatherCodes[8]; // 8:00の天気
  int afternoonWeatherCode = 42;//weatherCodes[14]; // 14:00の天気
  int eveningWeatherCode = 79;//weatherCodes[20]; // 20:00の天気

  String morningWeather =
      classifyWeather(weatherDictionary[morningWeatherCode] ?? "不明");
  String afternoonWeather =
      classifyWeather(weatherDictionary[afternoonWeatherCode] ?? "不明");
  String eveningWeather =
      classifyWeather(weatherDictionary[eveningWeatherCode] ?? "不明");

  return "\u{1F557}:${morningWeather} / \u{1F551}:${afternoonWeather} / \u{1F557}:${eveningWeather}";
}

String classifyWeather(String weather) {
  Map<String, String> categories = {
    "厚い巻層雲": "曇り",
    "暴風雪": "雪",
    "暴風": "砂じん嵐",
    "氷雨": "ひょう",
    "濃い霧": "煙霧",
    "大雪": "雪",
    "激しい雨": "雨",
    "快晴": "快晴",
    "おおむね晴れ": "晴れ",
    "主に晴れ": "晴れ",
    "長い晴れ間": "晴れ",
    "一部曇り": "薄曇り",
    "雲の切れ間": "薄曇り",
    "やや曇り": "薄曇り",
    "主に曇り": "曇り",
    "曇り": "曇り",
    "???": "???",
    "霧": "煙霧",
    "雷": "雷",
    "にわか雨": "雨",
    "孤立した雷雨": "雷",
    "突風": "砂じん嵐",
    "吹き出し": "砂じん嵐",
    "霧雨の可能性": "霧雨",
    "雨の可能性": "雨",
    "雪の可能性": "雪",
    "小雨と雪": "みぞれ",
    "軽い氷雨": "ひょう",
    "小雨": "雨",
    "小雪": "雪",
    "小雪または雨雪混じりのにわか雨": "みぞれ",
    "霧の可能性": "煙霧",
    "砂嵐": "砂じん嵐",
    "激しい砂嵐": "砂じん嵐",
    "スノーフラッシャー": "地ふぶき",
    "流れ雪": "雪",
    "重い雪": "雪",
    "パッチ状の霧": "煙霧",
    "濃霧": "煙霧",
    "氷結霧": "煙霧",
    "凍てつく霧": "煙霧",
    "弱い霧雨": "霧雨",
    "時折降る霧雨": "霧雨",
    "時折強い霧雨": "霧雨",
    "激しい霧雨": "霧雨",
    "霧雨と雨": "霧雨",
    "時雨": "雨",
    "ときどき強い雨": "雨",
    "雨と雪": "みぞれ",
    "大雨と雪": "みぞれ",
    "時折雪": "雪",
    "ときどき雪": "雪",
    "ときどき大雪": "雪",
    "ダイヤモンドダスト": "雪",
    "雪の粒": "雪",
    "雪の結晶": "雪",
    "氷の粒": "あられ",
    "激しいにわか雨": "雨",
    "雨と雪のシャワー": "みぞれ",
    "激しい雨と雪": "みぞれ",
    "スノーシャワー": "雪",
    "激しい雪のシャワー": "雪",
    "小雪または雨雪混じりの激しいにわか雨": "みぞれ",
    "雹": "ひょう",
    "激しいあられ": "あられ",
    "激しい雷雨": "雷",
    "砂嵐を伴う激しい雷雨": "雷",
    "雹または突風を伴う激しい雷雨": "雷"
  };

  Map<String, String> emojiUnicodeInfo = {
    "快晴": "\u{2600}",
    "晴れ": "\u{2600}",
    "薄曇り": "\u{26C5}",
    "曇り": "\u{2601}",
    "煙霧": "\u{1F32B}",
    "砂じん嵐": "\u{1F32A}",
    "地ふぶき": "\u{1F32A}",
    "霧": "\u{1F32B}",
    "霧雨": "\u{1F327}",
    "雨": "\u{2614}",
    "みぞれ": "\u{2614}",
    "雪": "\u{2603}",
    "あられ": "\u{1F328}",
    "ひょう": "\u{1F328}",
    "雷": "\u{26A1}",
    "???": "\u{2753}"
  };

  if (categories.containsKey(weather)) {
    var emoji = emojiUnicodeInfo[categories[weather]]!;
    return emoji;
  } else {
    return "該当するカテゴリが存在しません";
  }
}
